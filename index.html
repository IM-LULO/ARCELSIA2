<!DOCTYPE html>
<html>
  <head>
    <title>WebXR AR Hit Test - Modelo Fijo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <!-- WebXR AR support -->
    <script src="https://cdn.jsdelivr.net/npm/aframe-ar-hit-test@1.0.0/dist/aframe-ar-hit-test.min.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="false"
      xrweb="allowedDevices: any"
      renderer="colorManagement: true; physicallyCorrectLights: true"
      webxr="overlayElement:#overlay; requiredFeatures: hit-test; optionalFeatures: dom-overlay"
      ar-hit-test="target:#reticle; autoHideReticle: false"
    >
      <a-camera camera look-controls wasd-controls="enabled: false"></a-camera>
      <!-- Retículo (círculo donde se colocará el modelo) -->
      <a-entity id="reticle"
                visible="false"
                position="0 0 -2"
                rotation="-90 0 0"
                geometry="primitive: ring; radiusInner: 0.09; radiusOuter: 0.1;"
                material="color: #FFC107; shader: flat; opacity: 0.8;">
      </a-entity>
      <!-- Modelo 3D, oculto por defecto -->
      <a-entity id="model"
                gltf-model="logocelsia.glb"
                visible="false"
                scale="1 1 1">
      </a-entity>
    </a-scene>
    <div id="overlay" style="position:absolute;top:10px;left:0;width:100%;text-align:center;z-index:10;">
      <button id="placeModelBtn" style="font-size:18px;padding:10px 20px;">Colocar modelo aquí</button>
      <p>Apunta al suelo y toca el botón para anclar el modelo.</p>
    </div>
    <script>
      // Lógica para anclar el modelo al hacer click en el botón
      let modelPlaced = false;
      const scene = document.querySelector('a-scene');
      const model = document.getElementById('model');
      const reticle = document.getElementById('reticle');
      const btn = document.getElementById('placeModelBtn');

      btn.addEventListener('click', function() {
        if (!modelPlaced && reticle.object3D.visible) {
          model.setAttribute('position', reticle.getAttribute('position'));
          model.setAttribute('visible', true);
          modelPlaced = true;
          btn.style.display = "none";
          reticle.setAttribute('visible', false);
        }
      });
    </script>
  </body>
</html>
